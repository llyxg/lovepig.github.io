<!DOCTYPE html>
<html>
<head>
    <!-- 添加预加载 -->
    <link rel="preload" href="img1.webp" as="image">
    <style>
        /* 保持原有样式不变 */
        .container {
            position: relative;
            height: 100vh;
        }
        #currentImage {
            position: absolute;
            left: 50%;
            top: 25%;
            transform: translate(-50%, -50%);
            max-width: 90%;
            max-height: 90%;
            transition: 0.3s;
            width: auto;
            height: auto;
        }
        /* 其他样式保持不变 */
    </style>
</head>
<body>
    <div class="container">
        <!-- 修改图片标签为兼容模式 -->
        <picture>
            <source srcset="img1.webp" type="image/webp">
            <img id="currentImage" 
                 src="img1.jpg"
                 width="800"    <!-- 添加实际显示尺寸 -->
                 height="600" 
                 loading="eager"
                 alt="互动演示图片">
        </picture>
        <div class="buttons">
            <button id="btn1">不要！</button>
            <button id="btn2">可以</button>
        </div>
    </div>

    <script>
        // 修改为WebP路径（需准备对应的.webp文件）
        const imagePaths = {
            initial: "img1.webp",
            step1: "img2.webp",
            step2: "img3.webp",
            step3: "img4.webp",
            step4: "img5.webp",
            final: "img6.webp"
        };

        // 添加WebP支持检测
        const supportsWebP = (() => {
            const elem = document.createElement('canvas');
            return elem.toDataURL('image/webp').indexOf('data:image/webp') === 0;
        })();

        let clickCount = 0;
        let currentScale = 1;

        const btn1 = document.getElementById('btn1');
        const btn2 = document.getElementById('btn2');
        const image = document.getElementById('currentImage');

        // 智能切换函数
        const smartSwitch = (webpPath, jpgPath) => {
            if (supportsWebP) {
                image.src = webpPath;
            } else {
                image.src = jpgPath;
            }
        };

        btn1.addEventListener('click', () => {
            clickCount++;
            
            // 根据点击次数切换
            const stepMap = [
                { webp: imagePaths.step1, jpg: "img2.jpg", text: '你认真的吗？' },
                { webp: imagePaths.step2, jpg: "img3.jpg", text: '要不再想想...' },
                { webp: imagePaths.step3, jpg: "img4.jpg", text: '不许点这个！' },
                { webp: imagePaths.step4, jpg: "img5.jpg", text: '拒绝的话猪猪会很伤心的' }
            ];

            if (clickCount <= 4) {
                const currentStep = stepMap[clickCount - 1];
                smartSwitch(currentStep.webp, currentStep.jpg);
                btn1.textContent = currentStep.text;
                
                // 缩放效果保持
                currentScale += 0.3;
                btn2.style.transform = `scale(${currentScale})`;
            }
        });

        btn2.addEventListener('click', () => {
            smartSwitch(imagePaths.final, "img6.jpg");
        });
    </script>
</body>
</html>
