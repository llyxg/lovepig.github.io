<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <style>
        /* 新增触摸反馈样式 */
        button:active {
            transform: scale(0.95);
            filter: brightness(0.9);
        }

        .container {
            position: relative;
            height: 100vh;
            overflow: hidden; /* 防止滚动干扰 */
        }

        #currentImage {
            position: absolute;
            left: 50%;
            top: 25%;
            transform: translate(-50%, -50%);
            max-width: 90%;
            max-height: 50vh; /* 给按钮留出更多空间 */
            z-index: 1; /* 确保图片在按钮下方 */
        }

        .buttons {
            position: fixed;
            bottom: 20px;
            width: 100%;
            display: flex;
            justify-content: center;
            gap: 20px;
            z-index: 100; /* 确保按钮在最顶层 */
            padding: 0 10px; /* 防止内容溢出 */
        }

        button {
            /* 移动端优化尺寸 */
            width: 45vw;
            height: 15vh;
            font-size: 1.5rem;
            /* 新增点击效果 */
            transition: all 0.1s ease;
        }

        /* 移动端特定样式 */
        @media (max-width: 768px) {
            .buttons {
                bottom: 10px;
                gap: 10px;
            }
            
            button {
                width: 40vw;
                height: 12vh;
                font-size: 1.2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <img id="currentImage" src="img1.jpg">
        <div class="buttons">
            <button id="btn1">不要！</button>
            <button id="btn2">可以</button>
        </div>
    </div>

    <script>
        // 图片预加载（带错误处理）
        function preloadImages() {
            Object.values(imagePaths).forEach(src => {
                const img = new Image();
                img.src = src;
                img.onerror = () => console.error('图片加载失败:', src);
            });
        }

        const imagePaths = {
            initial: "img1.jpg",
            step1: "img2.jpg",
            step2: "img3.jpg",
            step3: "img4.jpg",
            step4: "img5.jpg",
            final: "img6.jpg"
        };

        // 初始化预加载
        preloadImages();

        let clickCount = 0;
        let currentScale = 1;
        const btn1 = document.getElementById('btn1');
        const btn2 = document.getElementById('btn2');
        const image = document.getElementById('currentImage');

        // 通用事件处理器
        function createHandler(fn) {
            return function(e) {
                e.preventDefault();
                e.stopPropagation();
                fn();
            }
        }

        // 按钮1功能
        const handleBtn1 = () => {
            clickCount++;
            const stepMap = {
                1: {img: imagePaths.step1, text: '你认真的吗？'},
                2: {img: imagePaths.step2, text: '要不再想想...'},
                3: {img: imagePaths.step3, text: '不许点这个！'},
                4: {img: imagePaths.step4, text: '拒绝的话猪猪会很伤心的'}
            };

            if (stepMap[clickCount]) {
                image.src = stepMap[clickCount].img;
                btn1.textContent = stepMap[clickCount].text;
            }

            currentScale += 0.3;
            btn2.style.transform = `scale(${currentScale})`;
        };

        // 按钮2功能
        const handleBtn2 = () => {
            image.src = imagePaths.final;
        };

        // 事件绑定（同时支持触摸和点击）
        const bindEvents = (element, handler) => {
            element.addEventListener('click', handler);
            element.addEventListener('touchstart', createHandler(handler));
            element.addEventListener('touchend', (e) => e.preventDefault());
        };

        bindEvents(btn1, handleBtn1);
        bindEvents(btn2, handleBtn2);

        // 初始化显示
        image.src = imagePaths.initial;
    </script>
</body>
</html>
